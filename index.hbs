{{!< default}}
{{!-- The tag above means: insert everything in this file
into the {body} of the default.hbs template --}}

{{!-- The big featured header, it uses blog cover image as a BG if available --}}
{{#get "posts" filter="featured:true" limit="1" as |featured|}}
{{#if featured}}
<header class="page-header top-story"
    style="background: linear-gradient(to top, rgba(0,0,0,0.3), rgba(0,0,0,0.3)), url({{featured.0.feature_image}}) no-repeat center / cover, #222">
    <div class="content container-flo">
        <h1 class="headline">{{featured.0.title}}</h1>
        <a class="button" href="{{featured.0.url}}">Lesen</a>
    </div>
    <figure class="wave"></figure>
</header>
{{else}}
{{#get "posts" limit="1" as |lastpost|}}
<header class="page-header top-story"
    style="background: linear-gradient(to top, rgba(0,0,0,0.3), rgba(0,0,0,0.3)), url({{lastpost.0.feature_image}}), #222">
    <div class="content container-flo">
        <h1 class="headline">{{lastpost.0.title}}</h1>
        <a class="button" href="{{lastpost.0.url}}">Lesen</a>
    </div>
    <figure class="wave"></figure>
</header>
{{/get}}
{{/if}}
{{/get}}

<main class="post-list container-flo">
    {{#get "posts" limit="1" as |lastpost|}}
    {{#if featured}}
    {{#get "posts" filter="featured:false" limit=@config.posts_per_page as |recents|}}
    {{#foreach recents}}
    {{> "post-card"}}
    {{/foreach}}
    {{/get}}
    {{else}}
    {{#get "posts" filter="id:-lastpost[0].id" limit=@config.posts_per_page as |recents|}}
    {{#foreach recents}}
    {{> "post-card"}}
    {{/foreach}}
    {{/get}}
    {{/if}}
    {{/get}}
</main>